MessageToPost
=============

.. code-block:: protobuf

    message MessageToPost {
        required string FromBoxId = 1;
        optional string ToBoxId = 2;
        repeated StructuredDataAttachment StructuredDataAttachments = 8;
        optional string ToDepartmentId = 12;
        optional bool IsDraft = 13 [default = false];
        optional bool LockDraft = 14 [default = false];
        optional bool StrictDraftValidation = 15 [default = true];
        optional bool IsInternal = 16 [default = false];
        optional string FromDepartmentId = 17;
        optional bool DelaySend = 18 [default = false];
        optional string ProxyBoxId = 26;
        optional string ProxyDepartmentId = 27;
        optional bool LockPacket = 32 [default = false];
        repeated DocumentAttachment DocumentAttachments = 34;
        optional LockMode LockMode = 35 [default = None];
    }

Структура данных *MessageToPost* представляет сообщение, подлежащее отправке через Диадок при помощи метода :doc:`../http/PostMessage`:

-  *FromBoxId* - идентификатор ящика отправителя сообщения.

-  *ToBoxId* - идентификатор ящика получателя сообщения. Должен отличаться от идентификатора ящика отправителя. Для внутреннего документа (IsInternal = true) этот идентификатор должен оставаться пустым (отсутствовать или содержать пустую строку).

-  *IsInternal* - флаг, показывающий, что сообщение является внутренним, то есть сообщением между подразделениями организации.

-  *ToDepartmentId* - идентификатор подразделения в организации получателя, в которое будут отправлены все документы из сообщения (может отсутствовать, в этом случае документы будут отправлены в головное подразделение)

-  *FromDepartmentId* - идентификатор подразделения отправителя сообщения.

-  :doc:`StructuredDataAttachments <StructuredDataAttachment>` - список файлов со структурированными данными в отправляемом сообщении,описывающими те или иные документы, представленные в виде печатных форм.

-  :doc:`DocumentAttachments <DocumentAttachment>` - список документов любых типов.

-  *ProxyBoxId* - идентификатор ящика, промежуточного получателя. Если указан ящик промежуточного получателя, то документ доставится конечному получателю только после того, как промежуточный получатель поставит подпись под документом. Если промежуточный получатель отклонит документ, то в ящик конечного получателя он не будет доставлен.

-  *ProxyDepartmentId* - идентификатор подразделения, в ящике промежуточного получателя.

-  *IsDraft* - флаг, показывающий, что данное сообщение является черновиком (возможно, содержит неподписанные документы), и не подлежит отправке. Для добавления подписей к черновику и его отправки следует использовать метод :doc:`../http/SendDraft`.

-  *LockDraft* - флаг, показывающий, что данный черновик является защищенным от изменений.

-  *StrictDraftValidation* - флаг, включающий проверку правильности черновика (по умолчанию проверка включена).

-  *DelaySend* - флаг, означает, что документ из сообщения будет сохранен без отправки. При этом, подпись под документом должна отсутствовать.

-  *LockPacket* - флаг, означает, что документы сообщения будут отправлены закрытым пакетом. В таком пакете любая операция применяется ко всем документам сразу. Эквивалентен *LockMode* = *Full*.

- *LockMode* - режим блокировки сообщения. Виды доступных режимы доступны в описании :doc:`../proto/LockMode`.

Сохраненные таким образом документы можно будет найти, используя метод :doc:`../http/GetDocuments`. Также можно их согласовывать, используя :doc:`../http/PostMessagePatch` или через веб-интерфейс.

После того как обработка на стороне отправителя больше не требуется, то документ можно подписать и отправить. Это можно сделать через веб-интерфейс или используя метод :doc:`../http/PostMessagePatch`

По умолчанию, все документы переданные одним сообщением будут связаны в пакет.
